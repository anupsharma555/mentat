<!DOCTYPE html>
<html>
  <head>
    <title>Paced Mentats: Expert Data Annotation</title>
    <script src="jspsych/jspsych.js"></script>
    <script src="jspsych/plugin-html-keyboard-response.js"></script>
    <script src="jspsych/plugin-image-keyboard-response.js"></script>
    <script src="jspsych/plugin-html-slider-response.js"></script>
    <script src="jspsych/plugin-survey-likert.js"></script>
    <script src="jspsych/plugin-preload.js"></script>
    <script src="plugin-survey-slider.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <!-- <script src="jspsych/jspsych.css"></script> -->
    <link href="jspsych/jspsych.css" rel="stylesheet" type="text/css" />
  </head>
  <body></body>
  <script>
    var jsPsych = initJsPsych({
        on_finish: function() {
            jsPsych.data.displayData();
        },
        show_progress_bar: true,
    });
    var timeline = [];

    // var preload = {
    // type: jsPsychPreload,
    // images: ['img/blue.png', 'img/orange.png']
    // };
    // timeline.push(preload);

    const welcome = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: 'Welcome to the data annotation process. Press any key to begin.'
    }
    timeline.push(welcome);

    const survey = {
        type: jsPsychSurveySlider,
        questions: [
            {prompt:'FIRST QUESTION', ticks:['0','100']},
            {prompt:'SECOND QUESTION', ticks:['0','100']},
        ],
        post_trial_gap: 2000
    };
    timeline.push(survey);

    function loadCsvAndCreateTrials(csvUrl, tml) {
            Papa.parse(csvUrl, {
                download: true,
                header: true,
                complete: function(results) {
                    const questions = results.data;
                    questions.forEach((row) => {
                        const trial = {
                            type: 'survey-multi-choice',
                            questions: [
                                {
                                    prompt: row.question,
                                    options: [row.choice1, row.choice2, row.choice3, row.choice4],
                                    required: true
                                }
                            ]
                        };
                        tml.push(trial);
                    });
                }
            });
        }

        // Call the function with the URL to your CSV file
        loadCsvAndCreateTrials('questions.csv', timeline);

    

    // var blue_trial = {
    // type: jsPsychImageKeyboardResponse,
    // stimulus: 'img/blue.png',
    // choices: ['f', 'j']
    // };

    // var orange_trial = {
    // type: jsPsychImageKeyboardResponse,
    // stimulus: 'img/orange.png',
    // choices: ['f', 'j']
    // };
    // timeline.push(blue_trial, orange_trial);

    // var test_stimuli = [
    // { stimulus: "img/blue.png"},
    // { stimulus: "img/orange.png"}
    // ];
    // var fixation = {
    // type: jsPsychHtmlKeyboardResponse,
    // stimulus: '<div style="font-size:60px;">+</div>',
    // choices: "NO_KEYS",
    // trial_duration: 1000,
    // };

    // var test = {
    // type: jsPsychImageKeyboardResponse,
    // stimulus: jsPsych.timelineVariable('stimulus'),
    // choices: ['f', 'j'],
    //     data: {
    //     task: 'annotation'
    // }
    // }
    // var test_procedure = {
    // timeline: [fixation, test],
    // timeline_variables: test_stimuli,
    // randomize_order: true
    // }
    // timeline.push(test_procedure);



    jsPsych.run(timeline);
  </script>
</html>